{% extends 'base.html.twig' %}

{% block title %}Mon Compte Client{% endblock %}

{% block body %}
<link rel="stylesheet" href="{{ asset('compte_client/style.css') }}">

<body class="client-body">
    <!-- Header avec logo et profil -->
    <div class="client-header">
        <a href="#" class="logo-button" onclick="toggleUserMenu(event)">
            <img src="{{ asset('/image/Illustration_sans_titre 12.png') }}" alt="Logo" class="logo-icon">
        </a>

        <!-- Menu utilisateur (cach√© par d√©faut) -->
        <div id="userMenu" class="user-menu hidden">
            <div class="user-menu-content">
                <p class="user-name">Connect√© en tant que</p>
                <p class="user-username">{{ app.user.nom }}</p>
                <form action="{{ path('app_logout') }}" method="post" class="logout-form" id="logoutForm">
                    <input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}">
                </form>
                <button type="button" class="logout-btn" onclick="document.getElementById('logoutForm').submit();">Se d√©connecter</button>
            </div>
        </div>

        <div class="profile-header">
            <div class="profile-pic-container">
                {% if app.user.profilImage %}
                    <img src="{{ asset('uploads/' ~ app.user.profilImage) }}" alt="Photo de profil" class="profile-pic">
                {% else %}
                    <div class="profile-pic-placeholder">
                        <span>‚ú®</span>
                    </div>
                {% endif %}
            </div>
            <h1 class="profile-name">{{ app.user.nom }}</h1>
        </div>
    </div>

    <!-- Boutons d'action -->
    <div class="action-buttons">
        <a href="{{ path('app_messagerie') }}" class="action-btn">
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
            Messagerie
        </a>

        <a href="{{ path('app_search_professionals') }}" class="action-btn">
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
            Rechercher
        </a>

        <a href="{{ path('app_parametre_client') }}" class="action-btn">
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="1"></circle>
                <circle cx="12" cy="5" r="1"></circle>
                <circle cx="12" cy="19" r="1"></circle>
            </svg>
            Modifier le profil
        </a>

        <a href="{{ path('app_publication_likes') }}" class="action-btn">
            <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            Publications aim√©es
        </a>
    </div>

    <!-- Artistes Favoris -->
    <div class="favoris-section">
        <h2 class="favoris-title">Mes Artistes Favoris ‚≠ê</h2>

        {% if app.user.favorisGives | length > 0 %}
            <div class="artistes-list">
                {% for favori in app.user.favorisGives %}
                    {% set artiste = favori.artiste %}
                    <div class="artiste-card">
                        <div class="artiste-header">
                            <div class="artiste-pic-container">
                                {% if artiste.profilImage %}
                                    <img src="{{ asset('uploads/' ~ artiste.profilImage) }}"
                                         alt="Photo de profil de {{ artiste.nom }}"
                                         class="artiste-pic">
                                {% else %}
                                    <div class="artiste-pic-placeholder">
                                        <span>üé®</span>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="artiste-info">
                                <h3 class="artiste-name">{{ artiste.nom }}</h3>
                                <p class="artiste-style">
                                    {% if artiste.style %}
                                        {{ artiste.style }}
                                    {% endif %}
                                </p>
                                <p class="artiste-location">
                                    {% if artiste.ville %}
                                        üìç {{ artiste.ville }}
                                    {% endif %}
                                </p>
                                {% if artiste.description %}
                                    <p class="artiste-description">{{ artiste.description }}</p>
                                {% endif %}
                            </div>
                        </div>
                        <a href="{{ path('app_profil_public', {'id': artiste.id}) }}" class="artiste-link">
                            Voir le profil
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-favoris">
                <p>Vous n'avez encore aucun artiste en favoris.</p>
                <a href="{{ path('app_search_professionals') }}" class="discover-link">D√©couvrez des artistes</a>
            </div>
        {% endif %}
    </div>

    <script>
        function toggleUserMenu(event) {
            event.preventDefault();
            const menu = document.getElementById('userMenu');
            menu.classList.toggle('hidden');
        }

        // Fermer le menu si on clique ailleurs
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('userMenu');
            const logoBtn = document.querySelector('.logo-button');
            if (!menu.contains(event.target) && !logoBtn.contains(event.target)) {
                menu.classList.add('hidden');
            }
        });
    </script>
</body>
{% endblock %}
